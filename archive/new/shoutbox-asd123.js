!function(){"use strict";moderator||document.styleSheets[0].insertRule(".admintool {display: none;}");const e=e=>document.querySelector(e),s=e=>document.querySelectorAll(e),t=(e,s)=>{const t=document.createElement(e);if(s?.attrs)for(const e in s.attrs)t.setAttribute(e,s.attrs[e]);if(s?.id&&(t.id=s.id),s?.class&&(t.className=s.class?.join?.(" ")??s.class),s?.style&&(t.style=s.style),s?.innerHTML&&(t.innerHTML=s.innerHTML),s?.textContent&&(t.textContent=s.textContent),s?.o)for(const e in s.o)t[e]=s.o[e];return s?.children&&t.append(...s.children.filter((e=>e))),t},n=(e,s,t)=>{const n=e.insertRow();n.insertCell(0).innerHTML=`<code>${s}</code>`,n.insertCell(1).innerHTML="|",n.insertCell(2).innerHTML=`<code>${t}</code>`},r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},a=e=>Object.entries(r).reduce(((e,[s,t])=>e.split(s).join(t)),e);{const s=t("div",{class:"pmtab tabShout",id:"private-messages",textContent:"Private Messages"}),n=t("div",{id:"socket-status"}),r=t("div",{class:"wrapShout",id:"pmarea-users",style:"display:none"}),a=t("div",{class:"wrapShout",id:"pmarea",style:"display:none"}),o=t("span",{id:"shout_text_reply"});e("div.tabShout a.telegram").parentElement?.after(s),s.after(n),e("#shoutarea").after(r,a),e("textarea#shout_text").before(o)}const o=io(sb_server,{query:{token:token}}),i={view:"shout",mode:"shout",pmUsers:[],userSettings:{volume:0,load_images:0,only_on_replies:0,muted:[]},updateView:s=>{i.view=s;const t=d.tabs;if("online"===s)p(t.activeUsers,t.shout,t.pms),g(d.userList,d.area,d.pmArea,d.pmUserArea);else if("pm"===s){p(t.pms,t.shout,t.activeUsers),g(d.pmArea,d.pmUserArea,d.area,d.userList);const s=c.find((e=>e.user?.uid===i.pmUserId))?.user.StyledName??i.activeUsers?.find((e=>e.uid===i.pmUserId))?.StyledName??i.pmUsers?.find((e=>e.uid===i.pmUserId))?.StyledName??i.pmUsername;e("#private-messages").innerHTML=`Private Messages with ${s}`,o.emit("pm-history",{uid:i.pmUserId})}else"pm-users"===s?(p(t.pms,t.shout,t.activeUsers),g(d.pmUserArea,d.pmArea,d.area,d.userList),d.input.disabled=!0):"shout"===s&&(p(t.shout,t.activeUsers,t.pms),g(d.area,d.userList,d.pmArea,d.pmUserArea));return"pm-users"!==s&&(d.input.disabled=!1),"pm"!==s&&(d.pmArea.innerHTML="",e("#private-messages").innerHTML="Private Messages",delete i.pmUserId,delete i.pmUsername),i},updateMode:s=>{if(i.mode=s,d.editBlock.innerHTML="",e("#shout_text_reply").textContent="","edit"===i.mode){const e=t("button",{class:"cancel-edit",textContent:"Cancel the edit"}),s=t("button",{class:"delete-shout",textContent:"Delete"});d.editBlock.append(e,s),e.addEventListener("click",(()=>{d.clearInput(),i.updateMode("shout"),delete i.editingId})),s.addEventListener("click",(()=>{o.emit("message-delete",{id:i.editingId}),d.clearInput(),i.updateMode("shout"),delete i.editingId}))}else if("reply"===i.mode){const e=t("button",{class:"cancel-edit",textContent:"Cancel the reply"});d.editBlock.append(e),e.addEventListener("click",(()=>{d.clearInput(),i.updateMode("shout"),delete i.replyingId}))}return i},saveSettings:()=>{const e=i.userSettings;o.emit("settings-save",{volume:e.volume,load_images:e.load_images,only_on_replies:e.only_on_replies,muted:e.muted})}};window.stateSetEdit=e=>i.editingId=e;const d={tabs:{shout:e(".shouttab"),activeUsers:e("#active-users"),pms:e("#private-messages")},status:e("#socket-status"),area:e("#shoutarea"),pmArea:e("#pmarea"),pmUserArea:e("#pmarea-users"),userList:e("#active-users-tab"),input:e("#shout_text"),sendMsg:e(".send-message"),editBlock:e("#edit-block"),remainingChars:e(".remaining-characters"),allMsgs:()=>s(".msgShout"),getMsg:(e,s)=>(s??d.area).querySelector(`.msgShout[id="${e}"]`),addMsg:(e,s=!1,t=!1,n=!1)=>{const r=n||t&&"pm"===i.view?d.pmArea:d.area,a=d.getMsg(e.id,r);if(a&&!s)return a.insertAdjacentElement("afterend",e),a.remove(),void h(e.id);if(o=e.querySelector(".content_msgShout")?.textContent??"",l=username,new RegExp(`@(${l??username})([^w-]|$)`,"i").test(o)){e.classList.add("mentionsUser");try{m.play()}catch{}}var o,l;r.appendChild(e),h(e.id)},addClientMsg:e=>{if(i.userSettings.muted.includes("BFWelcome")&&'Welcome to the BreachForums shoutbox! To learn more, run <button style="color:grey" class="command-button" onclick="HelpMessage();"><code>/help</code></button>.'===e)return;const s=t("div",{class:"msgShout",children:[t("span",{class:"BF",textContent:"#BF"}),t("span",{class:"username_msgShout",innerHTML:'<span style="color: #ffef00;font-weight: bold;">System Message</span>'}),t("span",{textContent:": "}),t("span",{class:"content_msgShout",innerHTML:e}),t("span",{class:"pm-tag",style:"font-size: 11px",textContent:"*Only you can see this message."})]});d.area.appendChild(s),d.scrollDown()},addPMUser:s=>{if(s.uid===user_id)return;if(e(`#pmarea-users div.msgShout[user-id="${s.uid}"]`))return;i.pmUsers.push(s);const n=t("div",{class:"msgShout",attrs:{"user-id":s.uid},children:[t("div",{class:"username_msgShout",innerHTML:s.StyledName})]});n.addEventListener("click",(()=>{i.pmUserId=s.uid,i.pmUsername=s.username,i.updateView("pm")})),d.pmUserArea.appendChild(n)},scrollDown:()=>{d.area.scrollHeight-d.area.scrollTop-400<140&&d.area.scrollTo(0,d.area.scrollHeight),d.pmArea.scrollHeight-d.pmArea.scrollTop-400<140&&d.area.scrollTo(0,d.area.scrollHeight)},updateCharsRem:()=>{d.remainingChars.textContent=`${Math.max(0,350-d.input.value.length)} characters left.`},clearInput:()=>{d.input.value="",d.updateCharsRem()}},l={imageProxy:"https://external-content.duckduckgo.com/iu/?u={image}",videoUrls:["a.pomf.cat","i.breached.to","i.breached.co","a.uguu.se","files.catbox.moe","cdn.discordapp.com"],youtubeUrls:["youtube.com","youtu.be"],extensions:{image:[".jpg",".jpeg",".png",".gif",".webp"],video:[".mp4",".mov"]}},u={server:["/ban","/unban","/disconnect-all","/purge"],client:["/mod-add","/mod-remove","/prune","/info","/user-info","/me","/staff-list","/clear","/help","/pm","/pm-mode","/pm-mode-off","/ignore","/unignore","/ignore-list","/ignore-clear","/welcome-off","/welcome-on"]},m=new Audio("new/msb_sound.mp3"),c=[];d.sendMsg.addEventListener("click",(()=>{const t=d.input.value.replace(/\s+$/,"").slice(0,350).replace(/\s+$/,"");if(t||"edit"===i.mode){if("pm"===i.view)return o.emit("message-send",{text:t,user:i.pmUsername,type:"private"}),void d.clearInput();if("shout"===i.mode){if("/"===t[0]){const e=t.replaceAll(/ {2,}/g," ").split(" ");if(![u.server,u.client].flat().includes(e[0]))return setTimeout((function(){$("#upd_alert").jGrowl("The command you attempted to send does not exist.",{life:1500})}),200);const n=e[0];if(u.server.includes(n))return d.clearInput(),o.emit("message-send",{text:t,type:"shout"});switch(n){case"/pm":if(!e[2])return;o.emit("message-send",{text:e.slice(2).join(" "),user:e[1],type:"private"});break;case"/mod-add":o.emit("mod-add",{user:e[1]});break;case"/mod-remove":o.emit("mod-remove",{user:e[1]});break;case"/staff-list":o.emit("get-staff",{});break;case"/info":o.emit("info",{});break;case"/user-info":o.emit("user-info",{user:e[1]??username});break;case"/me":o.emit("message-send",{text:e.slice(1).join(" "),type:"system"});break;case"/pm-mode":case"/pm-mode-off":break;case"/ignore":{const t=e[1].replace("@","");i.userSettings.muted.push(t),i.saveSettings(),s(`.msgShout[username="${t}"]`)?.forEach((e=>e.remove())),d.addClientMsg("You have successfully added "+a(t)+" to your ignore list.");break}case"/unignore":{const s=e[1].replace("@","");i.userSettings.muted=i.userSettings.muted.filter((e=>e!==s)),i.saveSettings(),d.addClientMsg("You have successfully removed "+a(s)+" from your ignore list.");break}case"/ignore-list":i.userSettings.muted.length?d.addClientMsg("You are currently ignoring: "+i.userSettings.muted.map((e=>a(e))).join(", ")):d.addClientMsg("You have no users on your ignore list.");break;case"/clear":s(".msgShout")?.forEach((e=>e.remove())),s(".msgReply")?.forEach((e=>e.remove())),d.addClientMsg("The chat has been cleared for you.");break;case"/prune":o.emit("prune-shoutbox",{});break;case"/help":y();break;case"/welcome-off":i.userSettings.muted.includes("BFWelcome")||i.userSettings.muted.push("BFWelcome"),i.saveSettings(),d.addClientMsg("Welcome messages disabled.");break;case"/welcome-on":i.userSettings.muted.includes("BFWelcome")&&(i.userSettings.muted=i.userSettings.muted.filter((e=>"BFWelcome"!==e))),i.saveSettings(),d.addClientMsg("Welcome messages enabled.")}return void d.clearInput()}return o.emit("message-send",{text:t,type:"shout"}),void d.clearInput()}if("reply"===i.mode)return o.emit("message-send",{text:t,type:"quote","quote-id":i.replyingId}),i.updateMode("shout"),delete i.replyingId,void d.clearInput();if(!t)return e(".delete-shout")?.click(),i.updateMode("shout"),void delete i.editingId;o.emit("message-edit",{text:t,id:i.editingId}),d.clearInput(),i.updateMode("shout"),delete i.editingId}})),d.input.addEventListener("input",(e=>{d.input.value.length>350&&(d.input.value=d.input.value.slice(0,350)),d.updateCharsRem()})),e("#active-users").addEventListener("click",(()=>i.updateView("online"))),e(".shouttab").addEventListener("click",(()=>i.updateView("shout"))),document.addEventListener("keydown",(e=>{if(e.target===d.input)switch(e.key){case"Enter":if(e.shiftKey)break;e.preventDefault(),d.sendMsg.click();break;case"Escape":d.clearInput(),i.updateMode("shout");break;case"ArrowUp":if("pm"===i.view)return;e.preventDefault(),b()}})),d.tabs.shout.addEventListener("click",(()=>i.updateView("shout"))),d.tabs.activeUsers.addEventListener("click",(()=>i.updateView("online"))),d.tabs.pms.addEventListener("click",(()=>{i.updateView("pm-users")}));const p=(e,...s)=>{e.classList.add("selected"),s.forEach((e=>e.classList.remove("selected")))},g=(e,...s)=>{e.style.display="block",s.forEach((e=>e.style.display="none"))};o.on("connect",(()=>{d.status.textContent="Connected",d.status.style.color="green",d.input.disabled=!1})),o.on("disconnect",(()=>{d.status.textContent="Disconnected",d.status.style.color="#b50f00",d.input.disabled=!0})),o.on("notification",(e=>{setTimeout((function(){$("#upd_alert").jGrowl(e.text,{life:1500})}),200)})),o.on("user-settings",(e=>{i.userSettings=e.settings,m.volume=e.settings.volume})),o.on("banned-users",(e=>{const s=e.map((e=>`<tr><td class="trow1" colspan="2"><div><a href="/User-${e.username}" target="_blank">${e.StyledUsername}</a></div></td></tr>`)).join(""),n=t("div",{class:"noticemod",style:"z-index: 7",innerHTML:`<div style="overflow-y: auto;max-height: 300px !important; "><table cellspacing="1" cellpadding="1" class="tborder"><tr><td class="thead" colspan="2"><div><strong>Banned Users</strong> (Latest 50 Bans)</div></td></tr>${s}</table></div><td></td>`});document.body.insertAdjacentElement("beforeend",n),$(".noticemod").modal({"z-index":7})})),o.on("purge-user",(e=>{for(const s of c)if(s.user.username===e.username){const e=d.getMsg(s.id);"msgQuote"===e?.parentElement?.className?e.parentElement?.remove():e?.remove(),c.splice(c.indexOf(s),1)}})),o.on("user-info",(e=>{const s=t("div",{class:"msgShout",children:[t("span",{class:"BF",textContent:"#BF"}),t("span",{class:"username_msgShout",innerHTML:'<span style="color: #ffef00;font-weight: bold;">System Message</span>'}),t("span",{innerHTML:": "}),t("span",{class:"content_msgShout",innerHTML:`Various information about ${e.styled_username} is listed below.`,children:[t("span",{class:"pm-tag",style:"font-size: 11px",textContent:"*Only you can see this message."}),t("br")]}),t("div",{style:"margin-bottom: 5px",innerHTML:"<code><u>General Information</u></code>"})]}),n=t("table");n.insertRow();Object.entries({UID:"uid",Username:"username","Styled Username":"",Banned:"","Banned By":"",Moderator:"","Total Messages Sent":"shout_count"}).forEach((([s,t])=>{if("Banned By"===t&&!e.banned)return;const r=n.insertRow();if(r.insertCell(0).innerHTML=`<code>${s}</code>`,r.insertCell(1).innerHTML="|",t)r.insertCell(2).innerHTML=`<code>${e[t]}</code>`;else{let t=e.moderator?"True":"False";"Styled Username"===s?t=`<a href="/User-${e.username}" target="_blank">${e.styled_username}</a>`:"Banned"===s?t=e.banned?"True":"False":"Banned By"===s&&(t=`<a href="/User-${e.banned_by.username}" target="_blank">${e.banned_by.StyledName}</a>`),r.insertCell(2).innerHTML=`<code>${t}</code>`}})),s.appendChild(n),d.area.appendChild(s),d.scrollDown()})),o.on("users",(e=>{d.userList.innerHTML="",i.activeUsers=Object.values(e);for(const s of Object.values(e)){const e=t("div",{class:"msgShout",attrs:{user:s.uid},children:[t("a",{attrs:{href:`https://breachforums.vc/User-${s.username}`,target:"_blank"},innerHTML:s.StyledName})]});e?.addEventListener("contextmenu",(e=>{e.preventDefault(),s.uid!==user_id&&(d.addPMUser(s),i.pmUserId=s.uid,i.pmUsername=s.username,i.updateView("pm"))})),d.userList.appendChild(e)}d.tabs.activeUsers.textContent=`Active Users: ${Object.values(e).length}`})),o.on("info",(e=>{const s=t("div",{innerHTML:'<span style="color: green;">[</span>#BF<span style="color: green;">]&nbsp;</span><span class="username_msgShout"><span style="color: #ffef00;font-weight: bold;">System Message</span></span>:<span class="content_msgShout" id="msgShout">Various information about shoutbox is listed below.<span class="pm-tag" style="font-size:11px;">*Only you can see this message.</span><br><br><div style="margin-bottom: 5px;"><code><u>Messages Leaderboard</u></code></div>'}),r=document.createElement("table");e.leaderboard.forEach((e=>{n(r,`&emsp;<a target="_blank" href="/User-${e.username}" target="_blank">${e.StyledUsername}</a>`,e.count)})),s.appendChild(r),s.innerHTML+='<br><div style="margin-bottom: 5px;"><code><u>General Information</u></code></div>';const a=document.createElement("table");n(a,"Total Messages Sent (By everyone)",e.message_counts.shoutbox),n(a,"Total Messages Sent (By you)",e.message_counts.personal),n(a,"Shoutbox Uptime",e.time_running),s.appendChild(a),s.innerHTML+="</span>",s.className="msgShout msgstcount null",s.setAttribute("username","null"),s.setAttribute("user-id","0"),d.area.appendChild(s),d.scrollDown()})),o.on("message-receive",(e=>{c.push(e),f(e)})),o.on("message-receive-system",(e=>{c.push(e),f(e)})),o.on("message-deleted",(e=>{const s=d.getMsg(e.id);"msgQuote"===s?.parentElement?.className?s.parentElement?.remove():s?.remove(),c.splice(c.findIndex((s=>s.id===e.id)),1)})),o.on("shoutbox-pruned",(()=>{d.allMsgs().forEach((e=>{"msgQuote"===e?.parentElement?.className?e.parentElement.remove():e.remove()}));for(let e=c.length;e>0;e--)c.pop()})),o.on("message-edited",(e=>{const s=c.find((s=>s.id===e.id)),t=d.getMsg(e.id);if(s||t)return s?(s.text=e.text,s.editedBy=e.edited_by,f(s)):void(t.querySelector(".edt_class").textContent=` [Last edit by: ${e.edited_by}]`)})),o.on("message-give",(e=>{"edit"===i.mode&&i.editingId===e.id&&(d.input.value=e.text,d.updateCharsRem())})),o.on("history",(e=>{const s=e.messages;if(0===d.area.children.length){for(const e of s){const s={id:e._id,text:e.message,user:{uid:e.uid||e["uid-from"],username:e.username||e["username-from"],StyledName:e.StyledUsername||e["StyledUsername-from"]},"uid-to":e["uid-to"],"uid-from":e["uid-from"],"username-to":e["username-to"],"username-from":e["username-from"],"StyledUsername-to":e["StyledUsername-to"],"StyledUsername-from":e["StyledUsername-from"],editedBy:e.edited_by.toString(),quoted_info:e.quoted_info,type:e.type};e.edited||delete s.editedBy,e.quoted_info||delete s.quoted_info,c.push(s)}f(...c),d.scrollDown()}s.forEach((e=>{"pm-history"===e.type&&d.addPMUser({uid:e["uid-from"],username:e["username-from"],StyledName:e["StyledUsername-from"],gid:"0"})}))})),o.on("pm-receive",(e=>{e["uid-from"]===user_id?d.addPMUser({uid:e["uid-to"],username:e["username-to"],StyledName:e["StyledUsername-to"],gid:"0"}):d.addPMUser({uid:e["uid-from"],username:e["username-from"],StyledName:e["StyledUsername-from"],gid:"0"}),e.editable=!1,c.push(e),f(e)})),o.on("pm-history-receive",(e=>{const s=[];for(const t of e)s.push({type:"shout",id:t._id,text:t.message,user:{uid:t["uid-from"],username:t["username-from"],StyledName:t["StyledUsername-from"],gid:"0"},pmTabOnly:!0});"pm"===i.view&&f(...s)})),o.on("staff-list",(e=>{const s=t("div",{innerHTML:'<span style="color: green;">[</span>#BF<span style="color: green;">]&nbsp;</span><span class="username_msgShout"><span style="color: #ffef00;font-weight: bold;">System Message</span></span>:<span class="content_msgShout" id="msgShout">A list of staff for the shoutbox are below.<span class="pm-tag" style="font-size:11px;">*Only you can see this message.</span><br><br><div style="margin-bottom: 5px;"><code><u>Shoutbox Staff</u></code></div>',class:"msgShout"});e.forEach((e=>s.innerHTML+=`<code>&emsp;<a target="_blank" href="/User-${e.username}">${e.StyledUsername}</a></code><br>`)),s.innerHTML+="<br></span>",d.area.appendChild(s),d.scrollDown()}));const h=e=>{1!==i.userSettings.load_images&&s(`div.msgShout[id="${e}"] a:not([href|="/User"]):not([href=""])`).forEach((s=>{const t=s.href;new URL(t);const n=l.extensions.image.some((e=>t.endsWith(e))),r=l.extensions.video.some((e=>t.endsWith(e))),o=l.youtubeUrls.some((e=>t.includes(e)));if(n){const n=l.imageProxy.replace("{image}",a(t));s.innerHTML=`<img src="${n}" style="max-width: 80px; max-height: 80px"/>`,s.href=n,s.addEventListener("contextmenu",(()=>v(void 0,e)))}if(r&&(s.innerHTML=`<video controls style="max-height: 130px; width: 260px;"><source src="${t}"/></video>`,s.removeAttribute("href"),s.addEventListener("contextmenu",(()=>v(void 0,e)))),o){const n=!(!(i=t.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/))||11!=i[7].length)&&i[7];if(!n)return;s.innerHTML=`<iframe width="315" height="175" src="https://www.youtube-nocookie.com/embed/${n}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`,s.removeAttribute("href"),s.addEventListener("contextmenu",(()=>v(void 0,e)))}var i}))},f=(...n)=>{for(const r of n){if(i.userSettings.muted.includes(r.user?.username))continue;const n=t("button",{class:"tag-button",textContent:"@"});n.addEventListener("click",(()=>{const e="pm"===r.type?"/pm ":"";d.input.value?d.input.value+=`${e} @${r.user?.username??r["username-from"]} `.replace("  "," "):d.input.value=`${e}@${r.user?.username??r["username-from"]} `,d.input.focus(),d.updateCharsRem()}));const o=t("button",{class:"edit-button",innerHTML:"<i>[Edit]</i>"});switch((r.user?.uid===user_id||moderator)&&o.addEventListener("click",(()=>b(r.id))),r.type){case"quote":case"shout":{const a=t("span",{class:"content_msgShout",innerHTML:M(r.text)}),l=t("div",{class:"msgShout",attrs:{username:r.user.username,user:r.user.uid},id:r.id,children:[t("span",{class:"BF",textContent:"#BF"}),r.user.uid!==user_id?n:null,t("a",{o:{href:`/User-${r.user.username}`,target:"_blank"},children:[t("span",{class:"username_msgShout",innerHTML:r.user.StyledName})]}),a,t("span",{class:"edt_class",textContent:r.editedBy?` [Last edit by: ${r.editedBy}]`:""}),"pm"===i.view||r.user.uid!==user_id&&!moderator?null:o]});if(l.querySelector("span.username_msgShout")?.addEventListener("contextmenu",(e=>{e.preventDefault(),r.user.uid!==user_id&&(d.addPMUser(r.user),i.pmUserId=r.user.uid,i.pmUsername=r.user.username,i.updateView("pm"))})),"quote"!==r.type||r.editedBy)r.pmTabOnly?"pm"===i.view&&d.addMsg(l,!1,!1,!0):d.addMsg(l);else{const s=JSON.parse(r.quoted_info),n=s.message.replace(/<span class='edited'.+?<\/span>/,""),a=t("div",{class:"msgReply",attrs:{"msg-id":s.id},textContent:`┏━━━━━ Replying to ${s.username}'s message: ${n.slice(0,75)}${n.length>75?"...":""}`}),o=t("div",{class:"msgQuote",children:[a,l]});a.addEventListener("click",(()=>{const t=e(`div.msgShout[id="${s.id}"]`);if(!t)return;const n="msgQuote"===t.parentElement?.className?t.parentElement:t;t&&!n.classList.contains("msgHighlightYellow")&&(d.area.scrollTo({top:n.offsetTop-100,behavior:"smooth"}),n.classList.add("msgHighlightYellow"),setTimeout((()=>n.classList.remove("msgHighlightYellow")),4350))})),s.username===username&&l.classList.add("mentionsUser"),d.addMsg(o)}r.editedBy&&s(`.msgReply[msg-id="${r.id}"]`).forEach((e=>{if(!e.textContent)return;const s=e.textContent.slice(0,e.textContent.indexOf(" message: ")+10),t=r.text.replace(/<span class='edited'.+?<\/span>/,"");e.textContent=s+t.slice(0,75)+(t.length>75?"...":"")})),a.addEventListener("contextmenu",(e=>{e.preventDefault(),v(e)}));break}case"pm":{n.classList.add("from-pm");const e=t("div",{class:"msgShout msgPM",attrs:{username:r["username-from"],user:r["uid-from"]},id:r.id,children:[t("span",{class:"BF",textContent:"#BF"}),"pm"!==i.view?t("a",{o:{href:`/User-${r["username-to"]}`,target:"_blank"},children:[t("span",{class:"pm-tag",innerHTML:r["uid-to"]===user_id?`[PM from ${r["StyledUsername-from"]}]`:`[PM to ${r["StyledUsername-to"]}]`})]}):null,r["uid-from"]!==user_id?n:null,t("a",{o:{href:`/User-${r["username-from"]}`,target:"_blank"},children:[t("span",{class:"username_msgShout",innerHTML:r["StyledUsername-from"]})]}),t("span",{class:"content_msgShout",innerHTML:M(a(r.text))}),t("span",{class:"edt_class",textContent:r.editedBy?` [Last edit by: ${r.editedBy}]`:""})]});"pm"===i.view&&i.pmUserId!==r["uid-from"]&&i.pmUserId!==r["uid-to"]||d.addMsg(e,!1,!0);break}case"system":{r.user.gid||(r.user.gid=c.find((e=>e.user.uid===r.user.uid))?.user.gid||"0");const e=t("div",{class:"msgShout",attrs:{username:r.user.username,user:r.user.uid},id:r.id,children:[t("span",{innerHTML:"*&nbsp;"+([3,6,12].includes(parseInt(r.user.gid))?'<b style="color: #a50000">BreachForums System</b>:&nbsp;':"")}),t("a",{o:{href:r.user.username.includes(" ")?void 0:`/User-${r.user.username}`,target:"_blank"},children:[t("span",{class:"username_msgShout noColon",innerHTML:r.user.StyledName})]}),t("span",{innerHTML:"&nbsp;"}),t("span",{class:"content_msgShout",innerHTML:r.text}),t("span",{innerHTML:"&nbsp;*"})]});r.user.uid&&e.querySelector("span.username_msgShout")?.addEventListener("contextmenu",(e=>{e.preventDefault(),r.user.uid!==user_id&&(d.addPMUser(r.user),i.pmUserId=r.user.uid,i.pmUsername=r.user.username,i.updateView("pm"))})),d.addMsg(e,!0);break}}}d.scrollDown()},y=()=>{const e=t("div",{class:"msgShout"});e.innerHTML+='<span style="color: green;">[</span>#BF<span style="color: green;">]&nbsp;</span><span class="username_msgShout"><span style="color: #ffef00;font-weight: bold;">System Message</span></span>:<span class="content_msgShout" id="msgShout">A list of commands for the shoutbox are below.<span class="pm-tag" style="font-size:11px;">*Only you can see this message.</span><br>',e.innerHTML+="<br>",e.innerHTML+='<div style="margin-bottom: 5px;"><code><u>General Commands</u></code></div>',e.innerHTML+="<code>&emsp;/help － Displays this.</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/me － Show a message about yourself. To use it, you would do /me {message}. Example usage: /me Is awesome</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/clear － Clear the chat client-side. Example usage: /clear</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/welcome-on － Turn on the welcome message. Example usage: /welcome-on</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/welcome-off － Turn off the welcome message. Example usage: /welcome-off</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/staff-list － Show a list of Forum & Shoutbox Staff. Example usage: /staff-list</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/info － Show information about the shoutbox. Example usage: /info</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/user-info － Show information about a shoutbox user. To use it, you would run /user-info {username}. Example usage: /user-info badhou3a</code>",e.innerHTML+="<br>",e.innerHTML+="<br>",e.innerHTML+='<div style="margin-bottom: 5px;"><code><u>Private Message System</u></code></div>',e.innerHTML+="<code>&emsp;/pm － Used for private-messaging in the shoutbox. To send a PM to a user, you would run /pm {username} {message}. Example usage: /pm pompompurin Hello!",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/pm-mode － Used for autofilling the private-message command. To turn it on, you would run /pm-mode {username}. Example usage: /pm-mode pompompurin</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/pm-mode-off － Used for turning off PM-Mode. Example usage: /pm-mode-off</code>",e.innerHTML+="<br>",e.innerHTML+="<br>",e.innerHTML+='<div style="margin-bottom: 5px;"><code><u>Ignore System</u></code></div>',e.innerHTML+="<code>&emsp;/ignore － Used to add a user to your ignore list. To use it, you would run /ignore {username}. Example usage: /ignore thekilob</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/unignore － Used to remove a user to your ignore list. To use it, you would run /unignore {username}. Example usage: /unignore badhou3a</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/ignore-list － Show a list of the users you have ignored. Example usage: /ignore-list</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/ignore-clear － Clears all of the users you have ignored. Example usage: /ignore-clear</code>",e.innerHTML+="<br>",e.innerHTML+="<br>",1===moderator&&(e.innerHTML+='<div style="margin-bottom: 5px;"><code><u>Staff Commands</u></code></div>',e.innerHTML+="<code>&emsp;/ban － Used to ban a user. To use it, you would run /ban {username}. Example usage: /ban thekilob</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/unban － Used to unban a user. To use it, you would run /unban {username}. Example usage: /unban badhou3a</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/disconnect-all － Disconnects every single user from the shoutbox. Example usage: /disconnect-all</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/purge － Delete every single message sent by a user. To use it, you would run /purge {username}. Example usage: /purge thekilob</code>",e.innerHTML+="<br>",e.innerHTML+="<code>&emsp;/prune － Delete ALL messages and private messages in the shoutbox currently. Example usage: /prune</code>",e.innerHTML+="<br><br><br>"),e.innerHTML+="</span>",d.area.appendChild(e),d.scrollDown()},b=e=>{const s=c.filter((e=>e.user?.uid===user_id));if(!e&&0===s.length)return;const t=e??s[s.length-1].id;t&&(i.updateMode("edit").editingId=t,o.emit("message-get",{id:t,type:"shout"}),d.input.focus())},v=(s,t)=>{if(s&&!t){let e=null,n=s.target.parentElement;for(let s=0;s<5;s++){if(!n)return;if(n.classList.contains("msgShout")){e=n.id;break}n=n.parentElement}t=e}if(!t)return;i.replyingId=t,i.updateMode("reply");const n=c.find((e=>e.id===t));n&&(e("#shout_text_reply").innerHTML=`Replying to ${n.user.StyledName}'s message: ${n.text}`),d.clearInput(),d.input.focus()};window.getBannedUsers=()=>o.emit("get-banned-users",{}),window.changeSettings=()=>{const s=t("div",{class:"settings-modal modal",innerHTML:`<div style="overflow-y: auto;max-height: 350px !important; "><table class="tborder" cellspacing="0" cellpadding="5"><tbody><tr><td class="thead" colspan="2"><div><strong>Settings</strong></div></td></tr><tr><td class="trow1"><input type="checkbox" id="load_image_links"${i.userSettings.load_images?"checked":""}>Load image link?</td></tr><tr><td class="tcat">Volume:</td></tr><tr><td class="trow1" style="text-align:center;">Min<input id="volume-setting" type="range" min="0" max="1" step="0.05" value="${i.userSettings.volume}">Max</td></tr><tr><td class="trow1"><input type="checkbox" id="mention_sound_only"${i.userSettings.only_on_replies?" checked":""}>Only on @ replies</td></tr><tr><td class="tcat">Ignored Users (Comma seperated list, i.e. exampleuser1,exampleuser2,badhou3a):</td></tr><tr><td class="trow1"><textarea id="ignored_users" style="width:97%;height: 36px;">${i.userSettings.muted}</textarea></td></tr></tbody></table></div><td><button class="settings-confirm" style="margin:4px;">Save Settings</button></td>`});document.body.appendChild(s),$(".settings-modal").modal({zIndex:7}),e("#volume-setting").addEventListener("change",(e=>{if(!e.currentTarget)return;const s=parseInt(e.currentTarget.value);m.volume=s,i.userSettings.volume=s;try{m.play()}catch{}})),e(".settings-confirm").addEventListener("click",(()=>{i.userSettings.load_images=e("#load_image_links").checked?1:0,i.userSettings.only_on_replies=e("#mention_sound_only").checked?1:0,i.userSettings.muted=e("#ignored_users").value.split(","),s.remove(),e("div.jquery-modal.blocker")?.remove(),i.saveSettings()}))},window.purgeShoutbox=()=>{const s=t("div",{innerHTML:'<div style="overflow-y: auto;max-height: 120px !important; "><table cellspacing="1" cellpadding="1" class="tborder"><tr><td class="thead" colspan="2"><div><strong>Prune Shoutbox</strong></div></td></tr><td class="trow1">Are you sure that you wish to purge the Shoutbox? All messages will be deleted.</td></table></div><td><button class="prune-confirm" style="margin:4px;">Prune</button></td>',class:"noticemod"});document.body.appendChild(s),$(".noticemod").modal({zIndex:7}),e(".prune-confirm").addEventListener("click",(()=>{o.emit("prune-shoutbox",{})}))},window.emoticons={dropdown:{":)":"/images/smilies/smile.png",";)":"/images/smilies/wink.png",":cool:":"/images/smilies/cool.png",":D":"/images/smilies/biggrin.png",":P":"/images/smilies/tongue.png",":rolleyes:":"/images/smilies/rolleyes.png",":shy:":"/images/smilies/shy.png",":(":"/images/smilies/sad.png",":at:":"/images/smilies/at.png",":angel:":"/images/smilies/angel.png",":@":"/images/smilies/angry.png",":blush:":"/images/smilies/blush.png",":s":"/images/smilies/confused.png",":dodgy:":"/images/smilies/dodgy.png",":exclamation:":"/images/smilies/exclamation.png",":heart:":"/images/smilies/heart.png",":huh:":"/images/smilies/huh.png",":idea:":"/images/smilies/lightbulb.png",":sleepy:":"/images/smilies/sleepy.png",":-/":"/images/smilies/undecided.png",":cry:":"/images/smilies/cry.png",":sick:":"/images/smilies/sick.png",":arrow:":"/images/smilies/arrow.png",":my:":"/images/smilies/my.png",":pomhappy:":"/resources/pomhappy.png",":pomthink:":"/resources/pomthink.png",":pomquestion:":"/resources/pomquestion.png",":pomlove:":"/resources/pomlove.png",":pomsleep:":"/resources/pomsleep.png",":kappa:":"/resources/kappa.png",":pomkill:":"/resources/pomkill.png",":pomsad:":"/resources/pomsad.png"}};const M=e=>{for(const[s,t]of Object.entries(emoticons.dropdown))e=e.replaceAll(s,`<img src="${t}" alt="${s}">`);return e}}();

